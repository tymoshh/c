function spin() {
  const button = document.getElementById('spinButton');
  if (balance < 10) {
    document.getElementById('result').textContent = "ğŸ’¸ Brak Å›rodkÃ³w!";
    return;
  }

  balance -= 10;
  document.getElementById('balance').textContent = `Saldo: ${balance}$`;
  document.getElementById('result').textContent = "ğŸ° KrÄ™cimy...";
  button.disabled = true;

  // animacja lokalna przez 0.5s
  let interval = setInterval(() => {
    document.getElementById('reel1').textContent = getRandomSymbol();
    document.getElementById('reel2').textContent = getRandomSymbol();
    document.getElementById('reel3').textContent = getRandomSymbol();
  }, 100);

  setTimeout(() => {
    clearInterval(interval);

    // Pobierz prawdziwy wynik z CGI
    fetch('/cgi-bin/game.cgi')
      .then(res => res.json())
      .then(data => {
        const [r1, r2, r3] = data.result;
        document.getElementById('reel1').textContent = r1;
        document.getElementById('reel2').textContent = r2;
        document.getElementById('reel3').textContent = r3;

        balance += data.win;
        document.getElementById('balance').textContent = `Saldo: ${balance}$`;
        document.getElementById('result').textContent = data.message;
        button.disabled = false;
      })
      .catch(err => {
        document.getElementById('result').textContent = "âŒ BÅ‚Ä…d poÅ‚Ä…czenia z serwerem";
        button.disabled = false;
      });

  }, 500);
}

function getRandomSymbol() {
  const symbols = ["ğŸ’", "ğŸ‹", "ğŸ‡", "ğŸ‰", "ğŸ””", "â­", "7ï¸âƒ£"];
  return symbols[Math.floor(Math.random() * symbols.length)];
}
